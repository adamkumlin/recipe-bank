---
import { actions } from "astro:actions";
import RecipeList from "../../components/RecipeList";
import Layout from "../../layouts/Layout.astro";
import type { RecipeResponse } from "../../lib/utils/types";

const token = Astro.cookies.get("token");
let recipes: RecipeResponse[] = [];
try {
    if (!token) {
        return;
    }
      const user = await Astro.callAction(actions.verifyUserJwt, token.value);
      const {data} = await Astro.callAction(actions.getUserRecipes, user.data.id);
      recipes = data;
} catch (e) {
    console.log(e)
}
---

<Layout>
<RecipeList recipes={recipes} client:load/>
</Layout>